var documenterSearchIndex = {"docs":
[{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"EditURL = \"https://github.com/Yujie-W/PlantHydraulics.jl/blob/master/docs/src/examples/diurnal.jl\"","category":"page"},{"location":"generated/diurnal/#Diurnal-cycle","page":"Diurnal","title":"Diurnal cycle","text":"","category":"section"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"# load packages\nusing PlantHydraulics\nusing PlotPlants\nusing ProgressMeter\nFT = Float32;\nnothing #hide","category":"page"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"# prescribing time series (two days)\nΔt    = FT(10);\nT_day = FT(24 * 60 * 60);\nTs    = collect(FT, 0:Δt:(2*T_day));\nHs    = Ts ./ 3600;\nRs    = (Hs .- 6) ./ 24 .* FT(2π);\nEs    = max.(FT(5e-4), sin.(Rs) ./ 100);\nnothing #hide","category":"page"},{"location":"generated/diurnal/#Water-contents","page":"Diurnal","title":"Water contents","text":"","category":"section"},{"location":"generated/diurnal/#Example-of-grass","page":"Diurnal","title":"Example of grass","text":"","category":"section"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"grass = create_grass_like_hs(FT(-2),FT(2),FT[0,-1,-2],FT[0,1,2]);\nLWCs  = similar(Es);\nfor i in eachindex(Es)\n    # update evaporation rate\n    for leaf in grass.leaves\n        leaf.q_out = Es[i];\n    end\n\n    # update water contents\n    update_PVF!(grass, Δt);\n\n    # calculate total leaf water content\n    lwc = 0;\n    for leaf in grass.leaves\n        lwc += leaf.area * leaf.v_storage;\n    end\n    LWCs[i] = lwc;\nend","category":"page"},{"location":"generated/diurnal/#Leaf-water-content","page":"Diurnal","title":"Leaf water content","text":"","category":"section"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"_fig,_axes = create_canvas(\"Leaf water content\"; figsize=(5.5,3.5));\n_ax1 = _axes[1];\n_bx1 = _ax1.twinx();\n_ax1.plot(Hs, Es, \"-\", color=\"salmon\");\n_bx1.plot(Hs, LWCs, \"-\", color=\"royalblue\");\n_ax1.set_xlabel(\"Hour (h)\");\n_ax1.set_ylabel(\"Leaf transpiration rate (mol m⁻² s⁻¹)\", color=\"salmon\");\n_ax1.set_xticks(collect(0:4:48));\n_ax1.set_xlim(0,48);\n_bx1.set_ylabel(\"Grass canopy water content (mol)\", color=\"royalblue\");\n_fig.set_tight_layout(true);\n_fig","category":"page"},{"location":"generated/diurnal/#Example-of-tree","page":"Diurnal","title":"Example of tree","text":"","category":"section"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"tree = create_tree_like_hs(FT(-2.1), FT(5.5), FT(10), FT[0,-1,-2,-3],\n                           collect(FT,0:1:20));\nLWCs = similar(Es);\nfor i in eachindex(Es)\n    # update evaporation rate\n    for leaf in tree.leaves\n        leaf.q_out = Es[i];\n    end\n\n    # update water contents\n    update_PVF!(tree, Δt);\n\n    # calculate total leaf water content\n    lwc = 0;\n    for leaf in tree.leaves\n        lwc += leaf.area * leaf.v_storage;\n    end\n    LWCs[i] = lwc;\nend","category":"page"},{"location":"generated/diurnal/#Leaf-water-content-2","page":"Diurnal","title":"Leaf water content","text":"","category":"section"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"_fig,_axes = create_canvas(\"Leaf water content\"; figsize=(5.5,3.5));\n_ax1 = _axes[1];\n_bx1 = _ax1.twinx();\n_ax1.plot(Hs, Es, \"-\", color=\"salmon\");\n_bx1.plot(Hs, LWCs, \"-\", color=\"royalblue\");\n_ax1.set_xlabel(\"Hour (h)\");\n_ax1.set_ylabel(\"Leaf transpiration rate (mol m⁻² s⁻¹)\", color=\"salmon\");\n_ax1.set_xticks(collect(0:4:48));\n_ax1.set_xlim(0,48);\n_bx1.set_ylabel(\"Tree canopy water content (mol)\", color=\"royalblue\");\n_fig.set_tight_layout(true);\n_fig","category":"page"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"","category":"page"},{"location":"generated/diurnal/","page":"Diurnal","title":"Diurnal","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#PlantHydraulics.jl","page":"Home","title":"PlantHydraulics.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Plant hydraulics package using numerical methods.","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"using PlantHydraulics\n\nleaf   = LeafHydraulics{Float32}();\ne_crit = leaf_e_crit(leaf);","category":"page"},{"location":"API/#API","page":"API","title":"API","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"CurrentModule = PlantHydraulics","category":"page"},{"location":"API/#Plant-Hydraulic-System","page":"API","title":"Plant Hydraulic System","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"The PlantHydraulics module provides two levels of hydraulics system:     organ-level and plant-level. The organ-level hydraulic systems include     Leaf, Root, and Stem (trunk and branch). The plant-level hydraulic system     is can be any combination of the three organs (custimized definition may     apply).","category":"page"},{"location":"API/#Leaf,-Root,-and-Stem-HS","page":"API","title":"Leaf, Root, and Stem HS","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"Plant hydraulics is segmented to three organ-level systems/structs     (LeafHydraulics, RootHydraulics, and     StemHydraulics) subject to an Abstract type     (AbstractHydraulicSystem). The major differences among the three     structs are","category":"page"},{"location":"API/","page":"API","title":"API","text":"LeafHydraulics has an extra-xylary component\nRootHydraulics has a rhizosphere component\nRootHydraulics and StemHydraulics have a gravity component","category":"page"},{"location":"API/","page":"API","title":"API","text":"See the documentation for each struct for more details:","category":"page"},{"location":"API/","page":"API","title":"API","text":"AbstractHydraulicSystem\nLeafHydraulics\nRootHydraulics\nStemHydraulics","category":"page"},{"location":"API/#PlantHydraulics.AbstractHydraulicSystem","page":"API","title":"PlantHydraulics.AbstractHydraulicSystem","text":"abstract type AbstractHydraulicSystem{FT}\n\nHierarchy of AbstractHydraulicSystem\n\nLeafHydraulics\nRootHydraulics\nStemHydraulics\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.LeafHydraulics","page":"API","title":"PlantHydraulics.LeafHydraulics","text":"mutable struct LeafHydraulics{FT}\n\nA struct that contains leaf hydraulics information.\n\nFields\n\narea\nLeaf area [m²]\nk_ox\nMaximal extra-xylary hydraulic conductance [mol s⁻¹ MPa⁻¹ m⁻²]\nk_sla\nMaximal leaf hydraulic conductance per leaf area [mol s⁻¹ MPa⁻¹ m⁻²]\nvc\nVulnerability curve\np_crt\nCritical xylem pressure [MPa]\nflow\nFlow rate in the xylem [mol s⁻¹]\np_dos\nLeaf xylem water pressure at the downstream end of leaf xylem [MPa]\np_leaf\nLeaf end water pressure at air-water interface [MPa]\np_ups\nLeaf xylem water pressure at the leaf base (upstream) [MPa]\nk_element\nList of leaf k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of leaf kr history per element\np_element\nList of xylem water pressure [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_old\nTemperature memory [K]\nT_sap\nUpstream sap temperature [K]\npv\nPressure volume curve for storage\np_storage\nPressure of storage\nv_maximum\nTotal capaciatance at Ψ = 0 [mol m⁻²]\nv_storage\nCurrent capaciatance at Ψ_leaf [mol m⁻²]\nq_in\nFlow rate into the tissue (used for non-steady state) [mol m⁻² s⁻¹]\nq_out\nFlow rate out of the tissue (used for non-steady state) [mol m⁻² s⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.RootHydraulics","page":"API","title":"PlantHydraulics.RootHydraulics","text":"mutable struct RootHydraulics{FT}\n\nA struct that contains root hydraulics information.\n\nFields\n\narea\nRoot cross-section area [m²]\nk_max\nMaximal hydraulic conductance [mol s⁻¹ MPa⁻¹]\nk_s\nMaximal xylem hydraulic conductivity [mol s⁻¹ MPa⁻¹ m⁻²]\nvc\nVulnerability curve\nΔh\nRoot z difference [m]\nk_rhiz\nRhizosphere  conductance [mol s⁻¹ MPa⁻¹]\nsh\nSoil hydraulics\nflow\nFlow rate in the xylem [mol s⁻¹]\np_dos\nXylem water pressure at the downstream end of xylem [MPa]\np_rhiz\nXylem-rhizosphere interface water pressure [MPa]\np_ups\nSoil matrix potential [MPa]\nk_element\nList of k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of kr history per element\np_element\nList of xylem water pressure [MPa]\np_gravity\nList of pressure drop caused by gravity [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_old\nTemperature memory [K]\nT_sap\nUpstream sap temperature [K]\npv\nPressure volume curve for storage\np_storage\nPressure of storage per element\nv_maximum\nMaximal storage per element [mol]\nv_storage\nStorage per element [mol]\nq_element\nList of xylem water flow [mol m⁻²]\nq_buffer\nList of buffer water flow [mol m⁻²]\nq_diff\nList of diiferntial water flow [mol m⁻²]\nq_in\nFlow rate into the tissue (used for non-steady state) [mol s⁻¹]\nq_out\nFlow rate out of the tissue (used for non-steady state) [mol s⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.StemHydraulics","page":"API","title":"PlantHydraulics.StemHydraulics","text":"mutable struct StemHydraulics{FT}\n\nA struct that contains stem hydraulics information.\n\nFields\n\narea\nStem cross-section area [m²]\nk_max\nMaximal hydraulic conductance [mol s⁻¹ MPa⁻¹]\nk_s\nMaximal xylem hydraulic conductivity [mol s⁻¹ MPa⁻¹ m⁻²]\nvc\nVulnerability curve\nΔh\nStem height difference [m]\np_dos\nXylem water pressure at the downstream end of xylem [MPa]\np_ups\nXylem water pressure at the base (upstream) [MPa]\nk_element\nList of k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of kr history per element\np_element\nList of xylem water pressure [MPa]\np_gravity\nList of pressure drop caused by gravity [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_old\nTemperature memory [K]\nT_sap\nUpstream sap temperature [K]\npv\nPressure volume curve for storage\np_storage\nPressure of storage per element\nv_maximum\nMaximal storage per element [mol]\nv_storage\nStorage per element [mol]\nq_element\nList of xylem water flow [mol m⁻²]\nq_in\nFlow rate into the tissue (used for non-steady state) [mol s⁻¹]\nq_out\nFlow rate out of the tissue (used for non-steady state) [mol s⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"API/","page":"API","title":"API","text":"To initialize a hydraulics system, one needs to provide the floating type, for     example:","category":"page"},{"location":"API/","page":"API","title":"API","text":"using PlantHydraulics\n\nFT = Float32;\nhs_leaf = LeafHydraulics{FT}();\nhs_root = RootHydraulics{FT}();\nhs_stem = StemHydraulics{FT}();","category":"page"},{"location":"API/#Whole-plant-HS","page":"API","title":"Whole-plant HS","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"Plants differ in their structures, for example, some plants have a canopy far     above the ground elevated by a trunk, some plants have a structured canopy     supported by branch systems, and some plant has no trunk at all. To     represent the structural differences, several types of plant hydraulics     systems are pre-defined, and they are GrassLikeHS,     PalmLikeHS, TreeLikeHS, and TreeSimple     structs subject to a AbstractPlantHS type, where HS stands for     hydraulic system. The major difference between the HSs are","category":"page"},{"location":"API/","page":"API","title":"API","text":"GrassLikeHS has only mutiple root and canopy layers, no trunk or   branch\nPalmLikeHS has multiple root layers, a trunk, and multiple canopy   layers, no branch system\nTreeLikeHS has multiple root layers, a trunk, and multiple branch +   canopy layers, and each branch corresponds to a canopy layer\nTreeSimple has one root, one stem, and one leaf for testing purpose","category":"page"},{"location":"API/","page":"API","title":"API","text":"See the documentation for each struct for more details:","category":"page"},{"location":"API/","page":"API","title":"API","text":"AbstractPlantHS\nGrassLikeHS\nPalmLikeHS\nTreeLikeHS\nTreeSimple","category":"page"},{"location":"API/#PlantHydraulics.AbstractPlantHS","page":"API","title":"PlantHydraulics.AbstractPlantHS","text":"abstract type AbstractPlantHS{FT}\n\nHierachy of AbstractPlantHS\n\nGrassLikeHS\nPalmLikeHS\nTreeLikeHS\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.GrassLikeHS","page":"API","title":"PlantHydraulics.GrassLikeHS","text":"mutable struct GrassLikeHS{FT}\n\nA plant hydraulic system like a grass, which contains multiple root layers, and multiple canopy layers. No trunk or branch system applies.\n\nFields\n\nn_root\nRoot Layers\nn_canopy\nCanopy Layers\nroots\nRoots system\nleaves\nLeaves\nroot_index_in_soil\nCorresponding soil layer per root layer\ncanopy_index_in_air\nCorresponding air layer per canopy layer\ncontainer_k\nConductances for each layer at given flow\ncontainer_p\nPressure for each layer at given flow\ncontainer_q\nFlow rate\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.PalmLikeHS","page":"API","title":"PlantHydraulics.PalmLikeHS","text":"mutable struct PalmLikeHS{FT}\n\nA plant hydraulic system like a palm, which contains multiple root layers, one trunk, and multiple canopy layers. No branch system applies.\n\nFields\n\nn_root\nRoot Layers\nn_canopy\nCanopy Layers\nroots\nRoots system\ntrunk\nTrunk\nleaves\nLeaves\nroot_index_in_soil\nCorresponding soil layer per root layer\ncanopy_index_in_air\nCorresponding air layer per canopy layer\ncontainer_k\nConductances for each layer at given flow\ncontainer_p\nPressure for each layer at given flow\ncontainer_q\nFlow rate\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.TreeLikeHS","page":"API","title":"PlantHydraulics.TreeLikeHS","text":"mutable struct TreeLikeHS{FT}\n\nA plant hydraulic system like a tree, which contains multiple root layers, one trunk, and multiple branch and canopy layers.\n\nFields\n\nn_root\nRoot Layers\nn_canopy\nCanopy Layers\nroots\nRoots system\ntrunk\nTrunk\nbranch\nBranch system\nleaves\nLeaves\nroot_index_in_soil\nCorresponding soil layer per root layer\ncanopy_index_in_air\nCorresponding air layer per canopy layer\ncontainer_k\nConductances for each layer at given flow\ncontainer_p\nPressure for each layer at given flow\ncontainer_q\nFlow rate\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.TreeSimple","page":"API","title":"PlantHydraulics.TreeSimple","text":"mutable struct TreeSimple{FT}\n\nA plant hydraulic system with one root, one stem, and one leaf for testing     purpose\n\nFields\n\nroot\nRoot\nstem\nStem\nleaf\nLeaf\nkrs\nRelative hydraulic conductance\n\n\n\n\n\n","category":"type"},{"location":"API/","page":"API","title":"API","text":"To ease the initialization of a plant hydraulics system, a few customized     functions are provided for quick initialization. More importantly,     modifications to each field in the struct are always allowed. The quick     functions are create_grass_like_hs, create_palm_like_hs     , and create_tree_like_hs:","category":"page"},{"location":"API/","page":"API","title":"API","text":"create_grass_like_hs\ncreate_palm_like_hs\ncreate_tree_like_hs","category":"page"},{"location":"API/#PlantHydraulics.create_grass_like_hs","page":"API","title":"PlantHydraulics.create_grass_like_hs","text":"create_grass_like_hs(\n            z_root::FT,\n            z_canopy::FT,\n            soil_bounds::Array{FT,1},\n            air_bounds::Array{FT,1}\n) where {FT<:AbstractFloat}\n\nCreate a GrassLikeHS, given\n\nz_root Maximal root depth (negative value)\nz_canopy Maximal canopy height (positive value)\nsoil_bounds Array of soil layer boundaries starting from 0\nair_bounds Array of air layer boundaries starting from 0\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.create_palm_like_hs","page":"API","title":"PlantHydraulics.create_palm_like_hs","text":"create_palm_like_hs(\n            z_root::FT,\n            z_trunk::FT,\n            z_canopy::FT,\n            soil_bounds::Array{FT,1},\n            air_bounds::Array{FT,1}\n) where {FT<:AbstractFloat}\n\nCreate a PalmLikeHS, given\n\nz_root Maximal root depth (negative value)\nz_trunk Maximal trunk height (positive value)\nz_canopy Maximal canopy height (positive value)\nsoil_bounds Array of soil layer boundaries starting from 0\nair_bounds Array of air layer boundaries starting from 0\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.create_tree_like_hs","page":"API","title":"PlantHydraulics.create_tree_like_hs","text":"create_tree_like_hs(\n            z_root::FT,\n            z_trunk::FT,\n            z_canopy::FT,\n            soil_bounds::Array{FT,1},\n            air_bounds::Array{FT,1}\n) where {FT<:AbstractFloat}\n\nCreate a TreeLikeHS, given\n\nz_root Maximal root depth (negative value)\nz_trunk Maximal trunk height (positive value)\nz_canopy Maximal canopy height (positive value)\nsoil_bounds Array of soil layer boundaries starting from 0\nair_bounds Array of air layer boundaries starting from 0\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"What these functions do are to determine how many root layers and branch/canopy     layers to add based on the tree information and environmental settings. To     determine number of root layers, rooting depth and the soil layer     information are required. The z_root is the maximal root depth in     negative number, and soil_bounds is the boundaries of soil layers staring     from 0. For example, for a soil_bounds of [0.0, -1.0, -2.0, -3.0, -4.0],     a z_root of -1 gives 1 root layer, and a z_root of -1.5 or -2.0 gives 2     root layers. The z_trunk, z_canopy, and air_bounds determine how many     canopy layers to add. For example, for a air_bounds of [0.0, 1.0, 2.0,     3.0, 4.0, 5.0 ... 20.0, 21.0, 22.0], a z_trunk of 5.0 z_canopy of 7.0     give 2 canopy layers, and a z_trunk of 5.5 z_canopy of 7.0 give 2     canopy layers. Also, the root_index_in_soil and canopy_index_in_air     indicate which soil or air layer the root or canopy layer corresponds with,     respectively. For instance, a index of 7 means that the canopy layer should     use the 7th air layer.","category":"page"},{"location":"API/","page":"API","title":"API","text":"To initialize a whole-plant hydraulic system, checkout the example below:","category":"page"},{"location":"API/","page":"API","title":"API","text":"using PlantHydraulics\n\nFT = Float32;\ngrass = create_grass_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\npalm  =  create_palm_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\ntree  =  create_tree_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\ntreet = TreeSimple{FT}();","category":"page"},{"location":"API/#Xylem-hydraulic-conductance","page":"API","title":"Xylem hydraulic conductance","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"Plants transport water through xylem conduits (vessels in most angiosperms,     trachieds in most gymnosperms). With the ascent of sap along the hydraulic     system, water pressure in the conduits is typically negative. The negative     xylem water pressure tends to pull air from surrounding tisses or the     atmosphere into the xylem conduits, resulting in xylem cavitation. The air     bubbles in cavitated conduits block water flow, and thus results in decline     of water transport capability (measured by xylem hydraulic conductance).","category":"page"},{"location":"API/","page":"API","title":"API","text":"Typically, the correlation between xylem water pressure (P leq 0) and     hydraulic conductance (k) is expressed by a Weibull function for     WeibullSingle type correlation:","category":"page"},{"location":"API/","page":"API","title":"API","text":"k = k_textmax cdot exp left( -left( dfrac-PB right)^C right)","category":"page"},{"location":"API/","page":"API","title":"API","text":"where k_textmax is the maximal hydraulic conductance, and B and C are     the Weibull parameters. This correlation is also known as vulnerability     curve (VC) to drought stress. Sometimes, plants exhibit a segmented VC, for     example, the fibers may transport water as well and are much more resistant     to drought than vessels. Thus, a dual Weibull function is presented for     WeibullDual type correlation (P leq 0):","category":"page"},{"location":"API/","page":"API","title":"API","text":"k = k_textmax cdot left f_1 cdot exp left -left( dfrac-PB_1 right)^C_1 right +\n                         (1 - f_1) cdot exp left -left( dfrac-PB_2 right)^C_2 right right","category":"page"},{"location":"API/","page":"API","title":"API","text":"The VC formulations are abstractized as","category":"page"},{"location":"API/","page":"API","title":"API","text":"AbstractXylemVC\nWeibullDual\nWeibullSingle","category":"page"},{"location":"API/#PlantHydraulics.AbstractXylemVC","page":"API","title":"PlantHydraulics.AbstractXylemVC","text":"abstract type AbstractXylemVC{FT}\n\nHierachy of AbstractXylemVC\n\nWeibullSingle\nWeibullDual\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.WeibullDual","page":"API","title":"PlantHydraulics.WeibullDual","text":"mutable struct WeibullDual{FT}\n\nStruct that contains dual Weibull function parameters.\n\nFields\n\nb1\nB of first part [MPa]\nc1\nC of first part\nf1\nF of first part\nb2\nB of second part [MPa]\nc2\nC of second part\nf2\nF of second part\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.WeibullSingle","page":"API","title":"PlantHydraulics.WeibullSingle","text":"mutable struct WeibullSingle{FT}\n\nStruct that contains single Weibull function parameters.\n\nFields\n\nb\nB of first part [MPa]\nc\nC of first part\n\n\n\n\n\n","category":"type"},{"location":"API/","page":"API","title":"API","text":"The function to call is","category":"page"},{"location":"API/","page":"API","title":"API","text":"xylem_k_ratio","category":"page"},{"location":"API/#PlantHydraulics.xylem_k_ratio","page":"API","title":"PlantHydraulics.xylem_k_ratio","text":"xylem_k_ratio(\n            vc::AbstractXylemVC{FT},\n            p_25::FT,\n            vis::FT\n) where {FT<:AbstractFloat}\n\nReturns the relative hydraulic conductance, given\n\nvc Xylem vulnerability curve\np Xylem pressure at 298.15 K in [MPa]\np_25 Equivalent xylem pressure at 298.15 K in [MPa]\nvis Relative viscosity. If missing, vis = 1.\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Note it here that xylem_k_ratio(vc, p) calculate the k without making     temperature corrections, but the xylem_k_ratio(vc, p_25, vis) makes     correction over the viscosity (the higher the viscosity, the lower the k).     Also, p_25 means that the pressure has been corrected to 298.15 K for     surface tension (the higher the surface tension, the more resistant the     xylem).","category":"page"},{"location":"API/","page":"API","title":"API","text":"Meanwhile, there is a function to call to calculate the critical pressure,     beyond which leaf will decicate. The critical pressure is calculated as the     pressure at which k is 0.001 of k_textmax for     WeibullSingle (for WeibullDual, each segment need to     reach 0.001). The functions is","category":"page"},{"location":"API/","page":"API","title":"API","text":"xylem_p_crit","category":"page"},{"location":"API/#PlantHydraulics.xylem_p_crit","page":"API","title":"PlantHydraulics.xylem_p_crit","text":"xylem_p_crit(vc::AbstractXylemVC{FT}, f_st::FT) where {FT<:AbstractFloat}\n\nReturns the relative hydraulic conductance, given\n\nvc Xylem vulnerability curve\nst Relative surface tension. If missing, vis = 1.\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Examples:","category":"page"},{"location":"API/","page":"API","title":"API","text":"using PlantHydraulics\n\nFT = Float32;\nvc_1 = WeibullSingle{FT}();\nvc_2 = WeibullDual{FT}();\n\nk_1 = xylem_k_ratio(vc_1, -1.0);\nk_2 = xylem_k_ratio(vc_2, -1.0);\nk_3 = xylem_k_ratio(vc_1, -1.0, 1.2);\nk_4 = xylem_k_ratio(vc_2, -1.0, 1.2);","category":"page"},{"location":"API/#Rhizosphere-hydraulic-conductance","page":"API","title":"Rhizosphere hydraulic conductance","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"As mentioned above, there is a rhizosphere component in the root hydraulic     system, and thus one needs to compute the pressure dtop along the     rhizosphere. The soil properties are classified to BrooksCorey     and VanGenuchten types subjected to AbstractSoilVC:","category":"page"},{"location":"API/","page":"API","title":"API","text":"AbstractSoilVC\nBrooksCorey\nVanGenuchten","category":"page"},{"location":"API/#PlantHydraulics.AbstractSoilVC","page":"API","title":"PlantHydraulics.AbstractSoilVC","text":"abstract type AbstractSoilVC{FT}\n\nHierachy of AbstractSoilVC:\n\nBrooksCorey\nVanGenuchten\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.BrooksCorey","page":"API","title":"PlantHydraulics.BrooksCorey","text":"mutable struct BrooksCorey{FT<:AbstractFloat}\n\nBrooks Corey soil parameters\n\nFields\n\nstype\nSoil type\nb\nSoil b\nϕs\nϕ at saturation [MPa]\nΘs\nSoil water content (Θ) at saturation\nΘr\nResidual soil water content\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantHydraulics.VanGenuchten","page":"API","title":"PlantHydraulics.VanGenuchten","text":"mutable struct VanGenuchten{FT<:AbstractFloat}\n\nVan Gunechten soil parameters\n\nFields\n\nstype\nSoil type\nα\nSoil α is related to the inverse of the air entry suction, α > 0\nn\nSoil n is Measure of the pore-size distribution\nm\nSoil m = 1 - 1/n\nΘs\nSoil water content (Θ) at saturation\nΘr\nResidual soil water content\n\n\n\n\n\n","category":"type"},{"location":"API/","page":"API","title":"API","text":"Pre-defined parameter sets are avialble, and you may quick create a soil type     struct using","category":"page"},{"location":"API/","page":"API","title":"API","text":"create_VanGenuchten\nVGClay\nVGClayLoam\nVGLoamySand\nVGLoamySand2\nVGSand\nVGSandyClayLoam\nVGSandyClayLoam2\nVGSandyLoam\nVGSilt\nVGSiltyClay\nVGSiltyClayLoam\nVGSiltyLoam","category":"page"},{"location":"API/#PlantHydraulics.create_VanGenuchten","page":"API","title":"PlantHydraulics.create_VanGenuchten","text":"create_soil_VC(\n            name::String,\n            α::FT,\n            n::FT,\n            Θs::FT,\n            Θr::FT) where {FT<:AbstractFloat}\n\nCreate a AbstractSoilVC type of soil VC, given\n\nname Soil type name\nα Soil α\nn Soil n\nΘs SWC at saturation\nΘr Residual SWC\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGClay","page":"API","title":"PlantHydraulics.VGClay","text":"Create VanGenuchten VC for Clay soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGClayLoam","page":"API","title":"PlantHydraulics.VGClayLoam","text":"Create VanGenuchten VC for Clay Loam soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGLoamySand","page":"API","title":"PlantHydraulics.VGLoamySand","text":"Create VanGenuchten VC for loamy sand soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGLoamySand2","page":"API","title":"PlantHydraulics.VGLoamySand2","text":"Create VanGenuchten VC for Loamy Sand 2 soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSand","page":"API","title":"PlantHydraulics.VGSand","text":"Create VanGenuchten VC for sand soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSandyClayLoam","page":"API","title":"PlantHydraulics.VGSandyClayLoam","text":"Create VanGenuchten VC for Sandy Clay Loam soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSandyClayLoam2","page":"API","title":"PlantHydraulics.VGSandyClayLoam2","text":"Create VanGenuchten VC for Sandy Clay Loam 2 soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSandyLoam","page":"API","title":"PlantHydraulics.VGSandyLoam","text":"Create VanGenuchten VC for Sandy Loam soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSilt","page":"API","title":"PlantHydraulics.VGSilt","text":"Create VanGenuchten VC for Silt soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSiltyClay","page":"API","title":"PlantHydraulics.VGSiltyClay","text":"Create VanGenuchten VC for Silty Clay soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSiltyClayLoam","page":"API","title":"PlantHydraulics.VGSiltyClayLoam","text":"Create VanGenuchten VC for Silty Clay Loam soil\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.VGSiltyLoam","page":"API","title":"PlantHydraulics.VGSiltyLoam","text":"Create VanGenuchten VC for Silty Loam soil\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Correlations among soil relative water content, relative hydraulic conductance,     and soil matrix potential are","category":"page"},{"location":"API/","page":"API","title":"API","text":"soil_erwc\nsoil_rwc\nsoil_swc\nsoil_k_ratio_erwc\nsoil_k_ratio_rwc\nsoil_k_ratio_swc\nsoil_k_ratio_p25\nsoil_p_25_erwc\nsoil_p_25_rwc\nsoil_p_25_swc","category":"page"},{"location":"API/#PlantHydraulics.soil_erwc","page":"API","title":"PlantHydraulics.soil_erwc","text":"soil_erwc(sh::AbstractSoilVC{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nReturns the Effective relative water content of the soil     fracΘs - ΘrΘs - Θ, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\ncorrection\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_rwc","page":"API","title":"PlantHydraulics.soil_rwc","text":"soil_rwc(sh::AbstractSoilVC{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nReturns the relative soil water content, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\ncorrection\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_swc","page":"API","title":"PlantHydraulics.soil_swc","text":"soil_swc(sh::AbstractSoilVC{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nReturns the soil water content, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\ncorrection\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_k_ratio_erwc","page":"API","title":"PlantHydraulics.soil_k_ratio_erwc","text":"soil_k_ratio_erwc(\n            sh::AbstractSoilVC{FT},\n            erwc::FT\n) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nerwc Effective relative soil water content (fracΘs - ΘrΘs - Θ)\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_k_ratio_rwc","page":"API","title":"PlantHydraulics.soil_k_ratio_rwc","text":"soil_k_ratio_rwc(sh::AbstractSoilVC{FT}, rwc::FT) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nrwc Relative soil water content\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_k_ratio_swc","page":"API","title":"PlantHydraulics.soil_k_ratio_swc","text":"soil_k_ratio_swc(sh::AbstractSoilVC{FT}, swc::FT) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nswc Relative soil water content\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_k_ratio_p25","page":"API","title":"PlantHydraulics.soil_k_ratio_p25","text":"soil_k_ratio_p25(\n            sh::AbstractSoilVC{FT},\n            p_25::FT\n) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh AbstractSoilVC type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_p_25_erwc","page":"API","title":"PlantHydraulics.soil_p_25_erwc","text":"soil_p_25_erwc(sh::AbstractSoilVC{FT}, erwc::FT) where {FT<:AbstractFloat}\n\nReturns the Relative water content of the soil, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nerwc Effectibe relative soil water content (fracΘs - ΘrΘs - Θ)\n\nNote that this function returns the matrix potential of water, not water potential. Also, the potential is that at 25 degree C, not yet been corrected for temperature effect on surface tension.\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_p_25_rwc","page":"API","title":"PlantHydraulics.soil_p_25_rwc","text":"soil_p_25_rwc(sh::AbstractSoilVC{FT}, rwc::FT) where {FT<:AbstractFloat}\n\nReturns the Relative water content of the soil, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nrwc Relative soil water content\n\nNote that this function returns the matrix potential of water, not water potential. Also, the potential is that at 25 degree C, not yet been corrected for temperature effect on surface tension.\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.soil_p_25_swc","page":"API","title":"PlantHydraulics.soil_p_25_swc","text":"soil_p_25_swc(sh::AbstractSoilVC{FT}, rwc::FT) where {FT<:AbstractFloat}\n\nReturns the Relative water content of the soil, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nswc Soil water content\n\nNote that this function returns the matrix potential of water, not water potential. Also, the potential is that at 25 degree C, not yet been corrected for temperature effect on surface tension.\n\n\n\n\n\n","category":"function"},{"location":"API/#Pressure-and-Flow","page":"API","title":"Pressure and Flow","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"The PlantHydraulics module is designed to run numerically for the following     reasons:","category":"page"},{"location":"API/","page":"API","title":"API","text":"Weibull function is cannot be integrated\nThe VC is segmented, i.e., if P  0, k = k_textmax (implemented in   xylem_k_ratio)\nOnce xylem cavitation occurs, it cannot be easily recovered unless P  0,   and thus there is a drought legacy effect. This is why there are a few   fields in the LeafHydraulics, RootHydraulics, and   StemHydraulics structs to store the drought history information.\nTemperature may change along the flow path. The f_st and f_vis in the   structs help deal with these effects.","category":"page"},{"location":"API/","page":"API","title":"API","text":"Function xylem_p_from_flow calculates the xylem end pressure for an     organ-level hysraulic system. As mentioned above, the     RootHydraulics and StemHydraulics has a gravity     component, and the RootHydraulics has a rhizosphere component.     Also be aware that xylem_p_from_flow accounts for temperature     effects on surface tension and viscosity.","category":"page"},{"location":"API/","page":"API","title":"API","text":"xylem_p_from_flow","category":"page"},{"location":"API/#PlantHydraulics.xylem_p_from_flow","page":"API","title":"PlantHydraulics.xylem_p_from_flow","text":"xylem_p_from_flow(\n            leaf::AbstractHydraulicSystem{FT},\n            flow::FT\n) where {FT<:AbstractFloat}\nxylem_p_from_flow(\n            tree::AbstractPlantHS{FT},\n            flow::FT\n) where {FT<:AbstractFloat}\nxylem_p_from_flow(\n            tree::TreeSimple{FT},\n            f_sl::FT,\n            f_sh::FT,\n            r_sl::FT\n) where {FT<:AbstractFloat}\n\nReturn the xylen end pressure(s) from flow rate(s), given\n\nleaf LeafHydraulics type struct\nroot RootHydraulics type struct\nstem StemHydraulics type struct\ntree AbstractPlantHS type struct\nflow Flow rate (per leaf area for LeafHydraulics)\nf_sl Flow rate to sunlit leaves\nf_sh Flow rate to shaded leaves\nr_sl Fraction of sunlit leaves\n\nNote, gravity is accounted for in root and stem; rhizosphere conductance is     accounted for in root; extra-xylary conductance is not accounted for in     leaf here because it calculates xylem end pressure.\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Noe that function xylem_p_from_flow does not update the pressure     profiles or history in the xylem. To update these profiles, use     hydraulic_p_profile!, and to remove these legacy profiles, use     inititialize_legacy!:","category":"page"},{"location":"API/","page":"API","title":"API","text":"hydraulic_p_profile!\ninititialize_legacy!","category":"page"},{"location":"API/#PlantHydraulics.hydraulic_p_profile!","page":"API","title":"PlantHydraulics.hydraulic_p_profile!","text":"hydraulic_p_profile!(\n            leaf::AbstractHydraulicSystem{FT},\n            flow::FT;\n            update::Bool = true\n) where {FT<:AbstractFloat}\nhydraulic_p_profile!(\n            tree::TreeSimple{FT},\n            p_soil::FT,\n            flow::FT;\n            update::Bool = true\n) where {FT<:AbstractFloat}\nhydraulic_p_profile!(\n            tree::TreeSimple{FT},\n            p_soil::FT,\n            f_sl::FT,\n            f_sh::FT,\n            r_sl::FT;\n            update::Bool = true\n) where {FT<:AbstractFloat}\nhydraulic_p_profile!(\n            tree::AbstractPlantHS{FT};\n            update::Bool = true\n) where {FT<:AbstractFloat}\n\nUpdate the pressure profile, given\n\nleaf LeafHydraulics type struct\nroot RootHydraulics type struct\nstem StemHydraulics type struct\ntree TreeSimple type struct\np_soil Soil water potential\nflow Flow rate (per leaf area for LeafHydraulics)\nf_sl Flow rate to sunlit leaves\nf_sh Flow rate to shaded leaves\nr_sl Fraction of sunlit leaves\nupdate Optional. If true, update drought legacy. Default is true for   TreeSimple but false for others using capacitance\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.inititialize_legacy!","page":"API","title":"PlantHydraulics.inititialize_legacy!","text":"inititialize_legacy!(\n            hs::AbstractHydraulicSystem{FT}\n) where {FT<:AbstractFloat}\ninititialize_legacy!(\n            tree::TreeSimple{FT}\n) where {FT<:AbstractFloat}\n\nInitialize the drought legacy effects in the xylem, given\n\nhs [AbstractHydraulicSystem] type struct\ntree TreeSimple type struct\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Examples:","category":"page"},{"location":"API/","page":"API","title":"API","text":"using PlantHydraulics\n\nFT = Float32;\nleaf = LeafHydraulics{FT}();\np = xylem_p_from_flow(leaf, FT(0.01));\n@show leaf.p_element;\nhydraulic_p_profile!(leaf, FT(0.01));\n@show leaf.p_element;","category":"page"},{"location":"API/#Root-Hydraulics","page":"API","title":"Root Hydraulics","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"Function xylem_p_from_flow works for the case of only 1 root layer if     one needs the plant base xylem water pressure. However, when there are     multiple root layers, xylem_p_from_flow does not apply. In this     case, iterations are required to calculate the xylem end pressure for each     root layers, and then make sure all root layers have the same xylem end     pressure. A few functions are provided to realize this.","category":"page"},{"location":"API/","page":"API","title":"API","text":"Function root_q_from_pressure uses Root Solving method to calculate     the flow rate through the RootHydraulics struct that yields the     given xylem end pressure. The ini in the function is optional. However,     using the flow rate from last instant when pressure does not differ much     will speed up the calculation.","category":"page"},{"location":"API/","page":"API","title":"API","text":"root_q_from_pressure","category":"page"},{"location":"API/#PlantHydraulics.root_q_from_pressure","page":"API","title":"PlantHydraulics.root_q_from_pressure","text":"root_q_from_pressure(\n            root::RootHydraulics{FT},\n            pressure::FT,\n            ini::FT\n) where {FT<:AbstractFloat}\n\nCalculate the flow rate from a given tree base pressure, given\n\nroot RootHydraulics type struct\npressure Given tree base pressure in [MPa]\nini Initial guess\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"In the plant hydraulic module design, flow rate is computed for each canopy     layer, and thus computing flow rate for each root layer is required for a     multiple layered root system. One feasible way is to do iterations using     root_q_from_pressure function, i.e., iterate the xylem end     pressure til the total flow rate equals the given value. However, this     method is too inefficient. What I did is","category":"page"},{"location":"API/","page":"API","title":"API","text":"Calculate the xylem end pressure and whole root layer conductance from the   initial flow rate;\nCalculate the mean xylem end pressure, and tune the flow rates in all root   layers using the difference from mean pressure and root conductance;\nSum up the new flow rates, and calculate the difference with given total flow   rate;\nUse the calculated condutcance to weight out the differences.","category":"page"},{"location":"API/","page":"API","title":"API","text":"The functions provided by PlantHydraulics module are","category":"page"},{"location":"API/","page":"API","title":"API","text":"root_pk_from_flow\nrecalculate_roots_flow!","category":"page"},{"location":"API/#PlantHydraulics.root_pk_from_flow","page":"API","title":"PlantHydraulics.root_pk_from_flow","text":"root_pk_from_flow(\n            root::RootHydraulics{FT},\n            flow::FT\n) where {FT<:AbstractFloat}\nroot_pk_from_flow(\n            root::RootHydraulics{FT},\n            q_in::FT,\n            flow::Array{FT,1}\n) where {FT<:AbstractFloat}\n\nReturn root xylem end pressure and root hydraulic conductance (reverse of     summed resistance), given\n\nroot RootHydraulics struct\nflow Given flow rate(s) in the root layer, array for non-steady state with   capacitance enabled\nq_in Flow rate into the root\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantHydraulics.recalculate_roots_flow!","page":"API","title":"PlantHydraulics.recalculate_roots_flow!","text":"recalculate_roots_flow!(\n            roots::Array{RootHydraulics{FT},1},\n            ks::Array{FT,1},\n            ps::Array{FT,1},\n            qs::Array{FT,1},\n            flow::FT\n) where {FT<:AbstractFloat}\nrecalculate_roots_flow!(\n            roots::Array{RootHydraulics{FT},1},\n            ks::Array{FT,1},\n            ps::Array{FT,1},\n            qs::Array{FT,1},\n            cs::Array{FT,2},\n            flow::FT\n) where {FT<:AbstractFloat}\n\nRecalculate the flow rates in the root from the pressure and conductance     profiles in each root at non-steady state, given\n\nroots Array of RootHydraulics structs\nks Container for conductance in each root layer\nps Container for end xylem pressure in each layer\nqs Container for flow rate out of each layer\nflow Total flow rate out of the roots\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"However, the steps above are only 1 iteration, and can only be used for the     non-steady state version of model. For the steady-state flow rates,     function roots_flow! does thw work. What the function does is to     iterate recalculate_roots_flow! till the difference among the     calculated end pressures is small enough. I also emphasize that to speed up     the code, 3 containers are added to the AbstractPlantHS structs,     and they are container_k, container_p, and container_q.","category":"page"},{"location":"API/","page":"API","title":"API","text":"roots_flow!","category":"page"},{"location":"API/#PlantHydraulics.roots_flow!","page":"API","title":"PlantHydraulics.roots_flow!","text":"roots_flow!(roots::Array{RootHydraulics{FT},1},\n            ks::Array{FT,1},\n            ps::Array{FT,1},\n            qs::Array{FT,1},\n            flow::FT\n) where {FT<:AbstractFloat}\nroots_flow!(plant::GrassLikeHS{FT},\n            flow::FT\n) where {FT<:AbstractFloat}\nroots_flow!(plant::PalmLikeHS{FT},\n            flow::FT\n) where {FT<:AbstractFloat}\nroots_flow!(plant::TreeLikeHS{FT},\n            flow::FT\n) where {FT<:AbstractFloat}\n\nSolve for the flow rates in each root layer and root pressure at steady state,     given\n\nroots Array of RootHydraulics structs\nks Container for conductance in each root layer\nps Container for end xylem pressure in each layer\nqs Container for flow rate in each layer\nflow Total flow rate\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Example:","category":"page"},{"location":"API/","page":"API","title":"API","text":"using PlantHydraulics\n\nFT = Float32;\npalm  =  create_palm_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\nroots_flow!(palm.roots, palm.container_k, palm.container_p, palm.container_q, FT(1));","category":"page"},{"location":"API/#Leaf-Hydraulics","page":"API","title":"Leaf Hydraulics","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"The stomatal models often require plant hydraulics either as a correction     factor (in empirical stomatal models) or as the risk term (in optimal     stomatal models). To facilitate the calculations, a few specific functions     are provided.","category":"page"},{"location":"API/","page":"API","title":"API","text":"Function leaf_xylem_risk returns the risk in xylem hydraulic function     based on the most downstream end of the xylem. The risk of plant hydraulic     system is not only on current system, but also potential new growth (plants     don't want to risk new growth either). Thus, function     leaf_xylem_risk evaluates the risk from the xylem pressure     calculated from current system (with drought history), and then compute the     risk from the pressure (the severer the srought history, the higher the     risk):","category":"page"},{"location":"API/","page":"API","title":"API","text":"leaf_xylem_risk","category":"page"},{"location":"API/#PlantHydraulics.leaf_xylem_risk","page":"API","title":"PlantHydraulics.leaf_xylem_risk","text":"leaf_xylem_risk(hs::LeafHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\n\nEvaluate the hydraulic risk at the end of leaf xylem, given\n\nhs LeafHydraulics type struct\nflow Flow rate (per leaf area)\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Note that function leaf_xylem_risk can work on its own without having     other organ-level components. For example, by changing the p_ups of a     LeafHydraulics, one can simulate the case of drought without     caring about other hydraulic systems. Same for function     leaf_e_crit below. However, these functions are only useful for     sensitivity analysis or when p_ups in the LeafHydraulics is     accurate.","category":"page"},{"location":"API/","page":"API","title":"API","text":"Examples","category":"page"},{"location":"API/","page":"API","title":"API","text":"using PlantHydraulics\n\nFT = Float32;\nleaf = LeafHydraulics{FT}();\nrisk = leaf_xylem_risk(leaf, FT(0.01));\n@show risk;\nleaf.p_ups = FT(-1.0);\nrisk = leaf_xylem_risk(leaf, FT(0.01));\n@show risk;","category":"page"},{"location":"API/","page":"API","title":"API","text":"Function leaf_e_crit calculates critical leaf transpiration rate,     beyond which leaf will desicate. Function leaf_e_crit accounts     for drought legacy effect by design, and the more severe the drought     history, the lower the e_crit. Again, ini in the function is also     optional, but a good guess will speed up the calculations.","category":"page"},{"location":"API/","page":"API","title":"API","text":"leaf_e_crit","category":"page"},{"location":"API/#PlantHydraulics.leaf_e_crit","page":"API","title":"PlantHydraulics.leaf_e_crit","text":"leaf_e_crit(hs::LeafHydraulics{FT},\n            ini::FT = FT(0.5)\n) where {FT<:AbstractFloat}\n\nCalculate the critical flow rate (K ≈ 0), given\n\nhs LeafHydraulics type struct\nini Initial guess\n\nNote, for the safety of no NaN, update e_crit when ΔP >= -0.01\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Examples","category":"page"},{"location":"API/","page":"API","title":"API","text":"using PlantHydraulics\n\nFT = Float32;\nleaf = LeafHydraulics{FT}();\nrisk = leaf_e_crit(leaf);\n@show risk;\nleaf.p_ups = FT(-1.0);\nrisk = leaf_e_crit(leaf);\n@show risk;","category":"page"},{"location":"API/#Whole-plant-Hydraulics","page":"API","title":"Whole-plant Hydraulics","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"Though leaf_xylem_risk and leaf_e_crit can work on their     own, the functions only evaluate the risks on leaf level. The more     realistic case is that when leaf transpiration rate increases, p_ups in     the LeafHydraulics gets more negative. Thus, the     leaf_xylem_risk and leaf_e_crit tends to underestimate     the risk and overestimate the critical flow rate. To overcome this problem,     whole-plant level plant hydraulics are provided.","category":"page"},{"location":"API/","page":"API","title":"API","text":"Function xylem_p_from_flow calculates the leaf xylem end pressure for     a whole-plant struct using these steps:","category":"page"},{"location":"API/","page":"API","title":"API","text":"calculate the plant base pressure from a given total flow rate\ncalculate the trunk end pressure (if present)\ncalculate the branch end pressure (if present)\ncalculate the leaf end pressure (if present)","category":"page"},{"location":"API/","page":"API","title":"API","text":"Accordingly, there is a function tree_e_crit to calculate the     critical flow rate for the whole plant. Be aware that Plant-level function     xylem_p_from_flow and tree_e_crit only applies to the     case of only one canopy layer (or big-leaf model). As to the case of     multiple canopy layer, more functions are pending.","category":"page"},{"location":"API/","page":"API","title":"API","text":"tree_e_crit","category":"page"},{"location":"API/#PlantHydraulics.tree_e_crit","page":"API","title":"PlantHydraulics.tree_e_crit","text":"tree_e_crit(tree::AbstractPlantHS{FT},\n            ini::FT = FT(0.5)\n) where {FT<:AbstractFloat}\n\nCalculate the critical flow rate for the tree per LA, given\n\ntree GrassLikeHS or PalmLikeHS or TreeLikeHS   type hydraulics system\nini Initial guess of the critical flow rate\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Note that the organ level or whole-plant level conductances are different from     xylem hydraulic conductance at a given xylem slice. Also, simply computing     the conductance as the flow rate divided by pressre drop is not accurate     because of the gravity. In the PlantHydraulics module, the organ and     whole-plant level conductances are computed by firstly adding up all the     resistances in each element, and then computing the relative loss of     conductance. The function available to use is","category":"page"},{"location":"API/","page":"API","title":"API","text":"plant_conductances!","category":"page"},{"location":"API/#PlantHydraulics.plant_conductances!","page":"API","title":"PlantHydraulics.plant_conductances!","text":"plant_conductances!(tree::TreeSimple{FT}) where {FT<:AbstractFloat}\n\nUpdate plant total hydraulic information in each element and whole plant, given\n\ntree TreeSimple type struct\n\n\n\n\n\n","category":"function"},{"location":"API/#Temperature-effects","page":"API","title":"Temperature effects","text":"","category":"section"},{"location":"API/","page":"API","title":"API","text":"Plant hydraulic properties changes with temperature, due to its impacts on     surface tension and viscosity. As to surface tension, when temperature     increases, air-water interface surface tension decreases, meaning that with     the same curvature, the capillary pressure provided decreases. As a result,     soil matrix potential becomes less nagative (good for plants!), but the     conduit resistance to cavitation decreases (bad for plants!). As to     viscosity, when temperature increases, viscosity decreases, meaning that     pressure drop decreases at the same flow rate (good for plants!). To     account for these effects, we provided vc_temperature_effects!     function:","category":"page"},{"location":"API/","page":"API","title":"API","text":"vc_temperature_effects!","category":"page"},{"location":"API/#PlantHydraulics.vc_temperature_effects!","page":"API","title":"PlantHydraulics.vc_temperature_effects!","text":"vc_temperature_effects!(\n            hs::LeafHydraulics{FT}\n) where {FT<:AbstractFloat}\nvc_temperature_effects!(\n            hs::AbstractHydraulicSystem{FT}\n) where {FT<:AbstractFloat}\nvc_temperature_effects!(\n            hs::AbstractHydraulicSystem{FT},\n            T::FT\n) where {FT<:AbstractFloat}\nvc_temperature_effects!(\n            tree::TreeSimple{FT}\n) where {FT<:AbstractFloat}\n\nUpdate temperature effetcs on hydralic system, given\n\nhs AbstractHydraulicSystem type struct\nT Given temperature\ntree TreeSimple type struct\n\n\n\n\n\n","category":"function"},{"location":"API/","page":"API","title":"API","text":"Keep in mind that, leaf critical pressure changes due to surface tension,     though the impact can be neglected for minor temperature change. However,     soil water content is still computed using the equivalent matrix potential     at 25 Celcius because water content is only related to the air-water     interface curvature.","category":"page"}]
}
